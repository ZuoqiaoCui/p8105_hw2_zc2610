p8105_hw2_zc2610
================
Zuoqiao Cui
2022-10-01

``` r
library(tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
    ## ✔ ggplot2 3.3.6      ✔ purrr   0.3.4 
    ## ✔ tibble  3.1.8      ✔ dplyr   1.0.10
    ## ✔ tidyr   1.2.0      ✔ stringr 1.4.1 
    ## ✔ readr   2.1.2      ✔ forcats 0.5.2 
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()

``` r
library(readxl)
library(dplyr)
```

## Problem 1

``` r
NYC_transit_data = read.csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names() %>% 
  select(line,station_name,station_latitude,station_longitude,starts_with("route"),entry, exit_only, vending, entrance_type, ada) %>% 
  mutate(
    entry = recode(entry,"YES" = TRUE,"NO" = FALSE),
    route8 = as.character(route8),
    route9 = as.character(route9),
    route10 = as.character(route10),
    route11 = as.character(route11)
  )
```

``` r
num_of_row = nrow(NYC_transit_data)
num_of_column = ncol(NYC_transit_data)
```

Description

1.  There are these variables: line, station_name, station_latitude,
    station_longitude, route1, route2, route3, route4, route5, route6,
    route7, route8, route9, route10, route11, entry, exit_only, vending,
    entrance_type, ada

2.  The process of tidying data is to import, update variable names,
    make all data type of column route to be the same: character, and
    selects the columns that will be used in later parts fo this
    problem. Then, I update `entry` from `yes` / `no` to a logical
    variable.

3.There are totally 1868 rows and 20 columns.

4.  I think it is not tidy enough since there are several columns
    regarding route and they can be combined to a column “route” with
    different numbers as values

Calculate the number of combinations of different station names and
lines

``` r
num_of_combination = NYC_transit_data %>% 
  select(station_name,line) %>% 
  distinct
```

Description There are totally 465 distinct stations

Calculate the number of stations where adas are compliant

``` r
num_of_combination_ada = NYC_transit_data %>%
filter(ada == TRUE) %>% 
  select(station_name,line) %>% 
  distinct
```

Description There are totally 84 distinct stations where adas are
compliant

calculate the proportion of station entrances / exits without vending
allow entrance

``` r
proportion = NYC_transit_data %>% 
  filter(vending == "NO") %>% 
  pull(entry) %>% 
  mean
proportion
```

    ## [1] 0.3770492

Description

The proportion of station entrances / exits without vending allow
entrance is 0.3770492

reform route number and route name calculate the number of distinct
stations that serve the A train

``` r
num_a = NYC_transit_data %>% 
  pivot_longer(
    route1:route11,
    names_to = "route_num",
    values_to = "route") %>% 
  filter(route == "A") %>% 
  select(station_name, line) %>% 
  distinct
```

Description

There are totally 60 distinct stations serve the A train

calculate the number of stations that serve the A train and are ADA
compliant

``` r
num_a_ada = NYC_transit_data %>% 
  pivot_longer(
    route1:route11,
    names_to = "route_num",
    values_to = "route") %>% 
  filter(route == "A", ada == TRUE) %>% 
  select(station_name, line) %>% 
  distinct
```

Description

There are totally 17 distinct stations that serve the A train and are
ADA compliant

## Problem 2

Import, clean, and organize the data for Mr Trash Wheel

``` r
MrTrashWheel_df = 
    read_excel("./data/Trash Wheel Collection Data.xlsx",sheet = "Mr. Trash Wheel",range = "A2:N550") %>% 
    janitor::clean_names() %>% 
    drop_na(dumpster) %>% 
    mutate(
      dumpster = as.character(dumpster),
      sports_balls = as.integer(round(sports_balls)),
      year = as.double(year)
    )
```

Import, clean, and organize the data for Professor Trash Wheel

``` r
ProfessorTrashWheel_df = 
    read_excel("./data/Trash Wheel Collection Data.xlsx",sheet = "Professor Trash Wheel",range = "A2:M97") %>% 
    janitor::clean_names() %>% 
    drop_na(dumpster) %>% 
    mutate(
      dumpster = as.character(dumpster)
    )
```

Combine two sheets

``` r
MrTrashWheel_df = MrTrashWheel_df %>% 
 mutate(type = "Mr. Trash Wheel")
ProfessorTrashWheel_df = ProfessorTrashWheel_df %>% 
  mutate(type = "Professor Trash Wheel")
TrashWheel_tidy = bind_rows(MrTrashWheel_df,ProfessorTrashWheel_df) %>% 
  janitor::clean_names() %>% 
  mutate(
    year = as.integer(year)
  )
```

Number of observations and variables in Mr Trash Wheel dataset

``` r
num_of_MrTrashWheel_observations = nrow(MrTrashWheel_df)
num_of_MrTrashWheel_variables = ncol(MrTrashWheel_df)
num_of_MrTrashWheel_observations
```

    ## [1] 547

``` r
num_of_MrTrashWheel_variables
```

    ## [1] 15

Number of observations and variables in Mr Trash Wheel dataset

``` r
num_of_ProfessorTrashWheel_observations = nrow(ProfessorTrashWheel_df)
num_of_ProfessorTrashWheel_variables = ncol(ProfessorTrashWheel_df)
num_of_ProfessorTrashWheel_observations
```

    ## [1] 94

``` r
num_of_ProfessorTrashWheel_variables
```

    ## [1] 14

Number of observations and variables in Mr Trash_tidy date frame

``` r
num_of_TrashWheel_tidy_observations = nrow(TrashWheel_tidy) 
num_of_TrashWheel_tidy_variables = ncol(TrashWheel_tidy)
num_of_TrashWheel_tidy_observations
```

    ## [1] 641

``` r
num_of_TrashWheel_tidy_variables
```

    ## [1] 15

Calculate the total weight of trash collected by professor trash wheel

``` r
professor_total_weight = sum(filter(TrashWheel_tidy,type == "Professor Trash Wheel")$weight_tons)
professor_total_weight
```

    ## [1] 190.12

Calculate the total number of sports bals collected by Mr trash wheel

``` r
Mr_total_sportsballs = sum((filter(TrashWheel_tidy,type == "Mr. Trash Wheel",year == 2020)$sports_balls))
Mr_total_sportsballs
```

    ## [1] 856

Description

1.There are totally 547 observations and 15 variables in the Mr Trash
Wheel dataset.

2.There are totally 94 observations and 14 variables in the Professor
Trash Wheel dataset.

3.There are totally 641 observations and 15 variables in the final
combined dataset.

4.Key variables contain “dumpster”,“year”,“weight_tons”,“sports_balls”
and so on. All variables are as followed: dumpster, month, year, date,
weight_tons, volume_cubic_yards, plastic_bottles, polystyrene,
cigarette_butts, glass_bottles, grocery_bags, chip_bags, sports_balls,
homes_powered, type

5.The total weight of trash collected by Professor Trash Wheel is 190.12

6.The total number of sports balls collected by Mr. Trash Wheel in 2020
is 856

## Problem 3

1.  Separate date into year, month and day
2.  Replace month number with month name

``` r
pols_month_df = 
    read_csv("./data/fivethirtyeight_datasets/pols-month.csv") %>% 
    janitor::clean_names() %>% 
    separate(mon,into = c("year","month","day"),sep = "-") %>% 
  mutate(
    month = recode(month, "01" = "January",
                  "02" = "February",
                  "03" = "March",
                  "04" = "April",
                  "05" = "May",
                  "06" = "June",
                  "07" = "July",
                  "08" = "Augest",
                  "09" = "September",
                  "10" = "October",
                  "11" = "November", 
                  "12" = "December"
    )
  )
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
pols_month_df
```

    ## # A tibble: 822 × 11
    ##    year  month     day   prez_…¹ gov_gop sen_gop rep_gop prez_…² gov_dem sen_dem
    ##    <chr> <chr>     <chr>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>
    ##  1 1947  January   15          0      23      51     253       1      23      45
    ##  2 1947  February  15          0      23      51     253       1      23      45
    ##  3 1947  March     15          0      23      51     253       1      23      45
    ##  4 1947  April     15          0      23      51     253       1      23      45
    ##  5 1947  May       15          0      23      51     253       1      23      45
    ##  6 1947  June      15          0      23      51     253       1      23      45
    ##  7 1947  July      15          0      23      51     253       1      23      45
    ##  8 1947  Augest    15          0      23      51     253       1      23      45
    ##  9 1947  September 15          0      23      51     253       1      23      45
    ## 10 1947  October   15          0      23      51     253       1      23      45
    ## # … with 812 more rows, 1 more variable: rep_dem <dbl>, and abbreviated
    ## #   variable names ¹​prez_gop, ²​prez_dem

create a president column using values prez_gop and prez_dem

``` r
pols_month_df = pols_month_df %>% 
  mutate(
    president = ifelse(prez_gop == 1, "gop",ifelse(prez_gop == 0,"dem","special case")))
  pols_month_df
```

    ## # A tibble: 822 × 12
    ##    year  month     day   prez_…¹ gov_gop sen_gop rep_gop prez_…² gov_dem sen_dem
    ##    <chr> <chr>     <chr>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>
    ##  1 1947  January   15          0      23      51     253       1      23      45
    ##  2 1947  February  15          0      23      51     253       1      23      45
    ##  3 1947  March     15          0      23      51     253       1      23      45
    ##  4 1947  April     15          0      23      51     253       1      23      45
    ##  5 1947  May       15          0      23      51     253       1      23      45
    ##  6 1947  June      15          0      23      51     253       1      23      45
    ##  7 1947  July      15          0      23      51     253       1      23      45
    ##  8 1947  Augest    15          0      23      51     253       1      23      45
    ##  9 1947  September 15          0      23      51     253       1      23      45
    ## 10 1947  October   15          0      23      51     253       1      23      45
    ## # … with 812 more rows, 2 more variables: rep_dem <dbl>, president <chr>, and
    ## #   abbreviated variable names ¹​prez_gop, ²​prez_dem

remove prez_gop,prez_dem and day variables

``` r
pols_month_df = pols_month_df %>% 
select(-prez_dem,-prez_gop,-day)
pols_month_df
```

    ## # A tibble: 822 × 9
    ##    year  month     gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president
    ##    <chr> <chr>       <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>    
    ##  1 1947  January        23      51     253      23      45     198 dem      
    ##  2 1947  February       23      51     253      23      45     198 dem      
    ##  3 1947  March          23      51     253      23      45     198 dem      
    ##  4 1947  April          23      51     253      23      45     198 dem      
    ##  5 1947  May            23      51     253      23      45     198 dem      
    ##  6 1947  June           23      51     253      23      45     198 dem      
    ##  7 1947  July           23      51     253      23      45     198 dem      
    ##  8 1947  Augest         23      51     253      23      45     198 dem      
    ##  9 1947  September      23      51     253      23      45     198 dem      
    ## 10 1947  October        23      51     253      23      45     198 dem      
    ## # … with 812 more rows

separate date into year, month, day

``` r
snps_df = read_csv("./data/fivethirtyeight_datasets/snp.csv") %>% 
  janitor::clean_names() %>% 
    separate(date,into = c("month","day","year"),sep = "/")
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

arrange year,month and organize them to be leading columns

``` r
snps_df = snps_df %>% 
mutate(
  year = as.integer(year),
  year = ifelse(year < 22,year + 2000,year + 1900)
) 
  snps_df = mutate(snps_df,
    year = as.character(year)
  ) %>% 
  arrange(year,month) %>% 
  relocate(year,month)
```

switch unemployment dataset from “wide” to “long” format

``` r
unemployment_df = read_csv("./data/fivethirtyeight_datasets/unemployment.csv") %>% 
  janitor::clean_names() %>% 
  pivot_longer(
    jan:dec,
    names_to = "month", 
    values_to = "percentage of unemployment") %>% 
  mutate(
    year = as.character(year)
  )
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

merge snps dataset into pols dataset and then merge unemployment dataset
into them

``` r
snps_pols_merge = left_join(pols_month_df,snps_df,by = c("year","month"))
merge_unemployment = left_join(snps_pols_merge,unemployment_df,by = c("year","month"))
```
